schema;node_olympus_schema:
  type: map
  nullable: false
  mapping:
    name: {type: str, nullable: false, range: {min: 1}}
    nodejs: {type: str, nullable: false, range: {min: 1}, func: dir_exists}
    debug: {type: bool, nullable: false}
    show_passwords: {type: bool, nullable: false}
    authentication:
      type: map
      nullable: false
      allowempty: true
      mapping:
        gameMasterPassword: {type: str, required: true, nullable: false, range: {min: 1}}
        blueCommanderPassword: {type: str, required: true, nullable: false, range: {min: 1}}
        redCommanderPassword: {type: str, required: true, nullable: false, range: {min: 1}}
        adminPassword: {type: str, nullable: false, range: {min: 1}}
    auto_affinity:
      type: map
      nullable: false
      mapping:
        min_cores: {type: int, nullable: false, range: {min: 1, max: 2}}
        max_cores: {type: int, nullable: false, range: {min: 1, max: 2}}
        quality: {type: int, nullable: false, range: {min: 0, max: 2}}

schema;instance_olympus_schema:
  type: map
  nullable: false
  allowempty: true
  mapping:
    enabled: {type: bool, nullable: false}
    name: {type: str, nullable: false, range: {min: 1}}
    debug: {type: bool, nullable: false}
    show_passwords: {type: bool, nullable: false}
    url: {type: url, nullable: false}
    auto_affinity:
      type: map
      nullable: false
      mapping:
        min_cores: {type: int, nullable: false, range: {min: 1, max: 2}}
        max_cores: {type: int, nullable: false, range: {min: 1, max: 2}}
        quality: {type: int, nullable: false, range: {min: 0, max: 2}}
    regex;(backend|server):
      type: map
      nullable: false
      required: true
      allowempty: true
      mapping:
        address: {type: str, nullable: false, range: {min: 1}}
        port: {type: int, nullable: false, func: unique_port}
    authentication:
      type: map
      nullable: false
      allowempty: true
      mapping:
        gameMasterPassword: {type: str, required: true, nullable: false, range: {min: 1}}
        blueCommanderPassword: {type: str, required: true, nullable: false, range: {min: 1}}
        redCommanderPassword: {type: str, required: true, nullable: false, range: {min: 1}}
        adminPassword: {type: str, nullable: false, range: {min: 1}}
    regex;(frontend|client):
      type: map
      nullable: false
      required: true
      allowempty: true
      mapping:
        path: {type: str, nullable: false, range: {min: 1}, func: dir_exists}
        port: {type: int, nullable: false, func: unique_port}
        customAuthHeaders:
          type: map
          nullable: false
          mapping:
            enabled: {type: bool, nullable: false}
            username: {type: str, nullable: false, range: {min: 1}}
            group: {type: str, nullable: false, range: {min: 1}}
        elevationProvider:
          type: map
          nullable: false
          mapping:
            provider: {type: url, nullable: false}
            username: {type: str}
            password: {type: str}
        mapLayers:
          type: map
          nullable: false
          mapping:
            regex;(.+):
              type: map
              nullable: false
              mapping:
                urlTemplate: {type: url, nullable: false}
                minZoom: {type: int, range: {min: 1}}
                maxZoom: {type: int, range: {max: 100}}
                attribution: {type: str, nullable: false, range: {min: 1}}
        mapMirrors:
          type: map
          nullable: false
          mapping:
            regex;(.+): { type: url, nullable: false}
        autoconnectWhenLocal: {type: bool, nullable: false}
        proxyHeader: {type: str, nullable: false, range: {min: 1}}
    audio:
      type: map
      nullable: false
      mapping:
        SRSPort: {type: int, nullable: false, func: obsolete}
        WSPort: {type: int, nullable: false, func: unique_port}
        WSEndpoint: {type: str, nullable: false, range: {min: 1}}
