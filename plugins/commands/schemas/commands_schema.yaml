schema;cmd_execute_schema:
  type: map
  nullable: false
  mapping:
    cmd: {type: str, required: true, nullable: false, range: {min: 1}}
    args: {type: str, nullable: false, range: {min: 1}}
    cwd: {type: str, nullable: false, range: {min: 1}, func: dir_exists}
    shell: {type: bool, nullable: false}

schema;cmd_event_schema:
  type: map
  allowempty: true
  nullable: false
  mapping:
    sync: {type: bool, nullable: false}
    # include: 'event_schema' # to check the events structure for DCS events

schema;cmd_params_schema:
  type: map
  nullable: false
  mapping:
    description: {type: str, nullable: false, range: {min: 1}}
    type: {type: str, nullable: false, enum: ['str', 'int', 'bool', 'member', 'channel', 'role', 'mentionable', 'number', 'attachment']}
    required: {type: bool, nullable: false}
    default: {type: text, nullable: false}
    nsfw: {type: bool, nullable: false}
    min_value: {type: int, nullable: false}
    max_value: {type: int, nullable: false}
    choices:
      type: seq
      nullable: false
      sequence:
        - {type: text, nullable: false, unique: true}

type: map
mapping:
  commands:
    type: map
    nullable: false
    mapping:
      regex;(.+):   # Any string as a command name
        type: map
        nullable: false
        mapping:
          description: {type: str, nullable: false, range: {min: 1}}
          roles:
            type: seq
            nullable: false
            sequence:
              - type: text
                nullable: false
          server: {type: any, nullable: false, func: str_or_list} # can be str or list[str]
          server_only: {type: bool, nullable: false}
          execute:
            include: 'cmd_execute_schema'
          event:
            include: 'cmd_event_schema'
          report: {type: str, nullable: false, range: {min: 1}}
          sequence:
            type: map
            nullable: false
            mapping:
              execute:
                include: 'cmd_execute_schema'
              event:
                include: 'cmd_event_schema'
          params:
            type: map
            mapping:
              regex;(.+):   # Any string as a parameter name
                include: 'cmd_params_schema'
